# 数据集划分说明

## 当前数据集状态

根据检查，数据集已经预划分：
- **训练集 (train)**: 2975 张图像
- **验证集 (val)**: 500 张图像
- **测试集 (test)**: 无

## 重要说明：图像生成任务的数据划分

**对于图像生成任务，测试集不是必须的！**

与分类任务不同，图像生成任务的特点：
1. **评估方式不同**：生成质量主要通过主观评价和生成指标（PSNR、SSIM、MAE、FID）评估，这些指标在验证集上计算即可
2. **验证集已足够**：验证集可以同时用于：
   - 训练过程中的模型选择（选择最佳checkpoint）
   - 超参数调优
   - 生成样例展示（三联图）
   - 最终评估报告（计算所有指标）
3. **避免过拟合**：生成模型主要关注生成质量而非泛化误差，验证集已经可以反映模型性能

## 推荐方案：直接使用现有划分（最简单）

**直接使用现有的train/val划分，无需划分测试集：**
- **训练集 (train)**: 2975 张（用于模型训练）
- **验证集 (val)**: 500 张（用于验证、模型选择、最终评估、生成样例展示）

**优点**：
- ✅ 简单直接，无需额外处理
- ✅ 训练集规模最大（2975张）
- ✅ 验证集规模足够（500张）
- ✅ 符合图像生成任务的实际需求

**使用方式**：
- 训练时使用train集
- 每个epoch在val集上计算指标和生成样例
- 最终报告使用val集的结果

## 可选方案：如果需要测试集（不推荐）

如果确实需要测试集（例如想要更严格的评估），可以考虑以下方案：

### 可选方案1：从验证集划分测试集

将验证集（500张）进一步划分为：
- **验证集 (val)**: 250 张（用于训练过程中的验证和模型选择）
- **测试集 (test)**: 250 张（用于最终评估，不参与训练和调参）

**缺点**：
- 验证集规模变小（250张），可能不够用
- 对于生成任务，这种划分意义不大

### 可选方案2：从训练集划分测试集

从训练集（2975张）中划分：
- **训练集 (train)**: 约2080张（70%）
- **验证集 (val)**: 约445张（15%，使用原val）
- **测试集 (test)**: 约450张（15%，从原train中划分）

**缺点**：
- 训练集减少，可能影响生成质量
- 对于生成任务，这种划分意义不大

## 最终推荐

**直接使用现有的train/val划分，无需划分测试集！**

这是最简单、最实用的方案，完全符合图像生成任务的需求。

如果确实需要划分测试集（不推荐），实现方式：

1. 运行 `src/data/split_data.py` 脚本
2. 从 `data/raw/cityscapes/val/` 中随机选择50%作为测试集
3. 将划分结果保存到 `data/splits/cityscapes_split_seed42.json`
4. 在数据处理时，根据划分索引文件加载对应的数据集

## 划分索引文件格式

**推荐格式（仅train和val）**：
```json
{
    "train": ["1.jpg", "2.jpg", "3.jpg", ...],
    "val": ["1.jpg", "2.jpg", "3.jpg", ...]
}
```

**说明**：
- train列表包含 `data/raw/cityscapes/train/` 目录中的所有图像文件名
- val列表包含 `data/raw/cityscapes/val/` 目录中的所有图像文件名
- 无需test字段，图像生成任务不需要测试集

## 注意事项

- **推荐**：直接使用train/val划分，无需划分测试集
- 如果确实需要测试集，使用固定随机种子（seed=42）确保实验可复现
- 划分后不要修改原始数据文件
- 所有实验使用相同的划分索引文件

