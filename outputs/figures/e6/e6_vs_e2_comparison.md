# 实验 E6 vs E2 对比分析报告

## 1. 实验配置对比

| 配置项 | E2 (L1 + GAN) | E6 (L1 + GAN + Feature Matching) |
|--------|---------------|-----------------------------------|
| **损失函数** | L_G = L_GAN + 100 × L_L1 | L_G = L_GAN + 100 × L_L1 + 10 × L_FM |
| **λ_L1** | 100.0 | 100.0 |
| **λ_FM** | - | 10.0 |
| **数据增强** | strong | strong |
| **训练 epoch** | 50 | 50 |
| **Batch size** | 1 | 1 |
| **Learning rate** | 2e-4 | 2e-4 |

## 2. 最佳 Epoch 结果对比

| 指标 | E2 (最佳 epoch 36) | E6 (最佳 epoch 31) | 差异 (E6 - E2) | 结论 |
|------|-------------------|-------------------|----------------|------|
| **Val L1/MAE ↓** | 0.1109 | 0.1119 | +0.0010 | E6 略差（+0.9%） |
| **PSNR ↑** | 16.275 dB | 16.132 dB | -0.143 dB | E6 略差（-0.9%） |
| **SSIM ↑** | 0.435 | 0.441 | +0.006 | E6 更好（+1.4%） |

## 3. 最后 Epoch (50) 结果对比

| 指标 | E2 (epoch 50) | E6 (epoch 50) | 差异 (E6 - E2) | 结论 |
|------|---------------|---------------|----------------|------|
| **Val L1/MAE ↓** | 0.1122 | 0.1224 | +0.0102 | E6 明显更差（+9.1%） |
| **PSNR ↑** | 16.150 dB | 15.658 dB | -0.492 dB | E6 明显更差（-3.0%） |
| **SSIM ↑** | 0.449 | 0.396 | -0.053 | E6 明显更差（-11.8%） |

## 4. 关键发现

### 4.1 训练稳定性

- **E2**: 最佳 epoch 在 36，之后性能保持稳定，最后 epoch 的 SSIM 甚至略有提升（0.435 → 0.449）
- **E6**: 最佳 epoch 在 31，之后性能开始下降，50 epoch 时所有指标都明显低于最佳 epoch
- **结论**: E6 存在明显的过拟合问题，应该在 epoch 31 附近早停

### 4.2 Feature Matching 的影响

**优点**:
- E6 的最佳 SSIM (0.441) 比 E2 (0.435) 高 1.4%，说明 Feature Matching 有助于提升结构相似度和感知质量
- Feature Matching 通过约束判别器中间层特征，使生成图像在特征空间更接近真实图像

**缺点**:
- E6 的最佳 PSNR 和 L1/MAE 略差于 E2（分别低 0.14 dB 和 0.001）
- 这可能是因为 Feature Matching 更关注特征空间的一致性，而非严格的像素级匹配
- λ_FM = 10.0 可能偏大，导致训练不稳定

### 4.3 后期训练行为

- **E2**: 在 50 epoch 时，虽然 L1 略有上升，但 SSIM 提升，说明模型在优化感知质量而非像素精度
- **E6**: 在 50 epoch 时，所有指标都显著下降，显示明显的过拟合
  - L1/MAE 从 0.1119 上升到 0.1224（+9.4%）
  - PSNR 从 16.132 下降到 15.658（-2.9%）
  - SSIM 从 0.441 下降到 0.396（-10.2%）

## 5. 建议

### 5.1 早停策略
- **E6 应该在 epoch 31 附近停止训练**，避免过拟合
- 可以设置验证集监控，当连续 5-10 个 epoch 性能不提升时自动停止

### 5.2 超参数调整
- **降低 λ_FM**: 尝试将 λ_FM 从 10.0 降低到 1.0-5.0，观察是否改善训练稳定性
- **学习率衰减**: 在 epoch 25 后降低学习率，可能有助于避免过拟合

### 5.3 定性分析
- 查看 epoch 31 和 epoch 50 的样例图，对比视觉质量差异
- 重点关注：
  - 细节保真度（Feature Matching 是否真的提升了细节）
  - 结构完整性（SSIM 提升是否反映在视觉上）
  - 过拟合迹象（是否出现不自然的纹理或伪影）

### 5.4 与 E7 对比
- 等待 E7 (Perceptual Loss) 结果，对比三种损失函数组合的效果：
  - E2: L1 + GAN
  - E6: L1 + GAN + Feature Matching
  - E7: L1 + GAN + Perceptual Loss

## 6. 总结

**Feature Matching 的贡献**:
- ✅ 提升了结构相似度（SSIM +1.4%）
- ⚠️ 略微牺牲了像素级精度（PSNR -0.9%, L1 +0.9%）
- ⚠️ 训练稳定性较差，容易过拟合

**适用场景**:
- 当**感知质量**比像素精度更重要时，Feature Matching 是有益的
- 需要配合**早停策略**和**合适的 λ_FM** 来避免过拟合
- 建议与 Perceptual Loss 对比，选择最适合的感知损失函数

